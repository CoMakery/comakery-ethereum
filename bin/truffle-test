#!/usr/bin/env node

const { d } = require('lightsaber')
const { exec } = require('shelljs')

const print = function(text, logger) {
  text = text.replace(/[\r\n]+$/, '')
  text = text.replace(/\u001b\[0m {6}\s*Contract:\s*\u001b\[0m/, '')
  if (text.trim()) { return logger(text) }
}

const command = 'truffle test --compile-all --network test'
const testRun = exec(command, {async: true, silent: true})
testRun.stdout.on('data', data => print(data, console.log))
testRun.stderr.on('data', data => print(data, console.error))
testRun.on('close', code => process.exit(code))
